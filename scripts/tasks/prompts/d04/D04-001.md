# Task D04-001: Claim state machine constants, import sources, auto-submission modes, validation check IDs, audit actions

## Project Context
- Monorepo: Turborepo + pnpm workspaces
- API: `apps/api` (Fastify 5, TypeScript)
- Shared: `packages/shared` (Drizzle schemas, Zod validators, constants)
- DB: PostgreSQL 16 with Drizzle ORM
- Test: Vitest + Supertest
- Auth: Lucia sessions with RBAC middleware from Domain 1
- All queries MUST include physician_id for tenant isolation (HIA custodian boundary)
- Claims contain PHI — no PHI in logs, errors, or emails. PHN masked as 123******
- State machine: 11 states, 5 terminal. Transitions enforced at service layer.

## What to Build

Create `packages/shared/src/constants/claim.constants.ts` with all Claim Lifecycle constants:

**ClaimState enum (11 states):**
- DRAFT, VALIDATED, QUEUED, SUBMITTED, ASSESSED, PAID, REJECTED, ADJUSTED, WRITTEN_OFF, EXPIRED, DELETED

**Terminal states set:** PAID, ADJUSTED, WRITTEN_OFF, EXPIRED, DELETED

**State transitions map (From -> allowed To[]):**
- (new) -> DRAFT
- DRAFT -> VALIDATED, DELETED
- VALIDATED -> DRAFT, QUEUED
- QUEUED -> VALIDATED, SUBMITTED
- SUBMITTED -> ASSESSED, REJECTED
- ASSESSED -> PAID, ADJUSTED
- REJECTED -> DRAFT, QUEUED, WRITTEN_OFF
- any non-terminal -> EXPIRED (system-initiated)

**ClaimType enum:** AHCIP, WCB

**ImportSource enum:** MANUAL, EMR_IMPORT, ED_SHIFT

**AutoSubmissionMode enum:**
- AUTO_CLEAN — clean claims auto-included, flagged claims require approval
- AUTO_ALL — both clean and flagged auto-included
- REQUIRE_APPROVAL — all claims require explicit approval

**ImportBatchStatus enum:** PENDING, PROCESSING, COMPLETED, FAILED

**ShiftStatus enum:** IN_PROGRESS, COMPLETED, SUBMITTED

**ClaimAuditAction enum (15 actions):**
- CREATED, EDITED, VALIDATED, QUEUED, UNQUEUED, SUBMITTED, ASSESSED, REJECTED, RESUBMITTED, WRITTEN_OFF, DELETED, EXPIRED, AI_SUGGESTION_ACCEPTED, AI_SUGGESTION_DISMISSED, DUPLICATE_ACKNOWLEDGED

**ActorContext enum:** PHYSICIAN, DELEGATE, SYSTEM

**Shared validation check IDs:**
- S1_CLAIM_TYPE_VALID, S2_REQUIRED_BASE_FIELDS, S3_PATIENT_EXISTS, S4_PHYSICIAN_ACTIVE, S5_DOS_VALID, S6_SUBMISSION_WINDOW, S7_DUPLICATE_DETECTION

**ValidationSeverity enum:** ERROR, WARNING, INFO

**Notification events:**
- CLAIM_VALIDATED, CLAIM_FLAGGED, DEADLINE_APPROACHING, DEADLINE_EXPIRED, BATCH_ASSEMBLED, BATCH_SUBMITTED, CLAIM_ASSESSED, CLAIM_REJECTED, CLAIM_PAID, DUPLICATE_DETECTED, AI_SUGGESTION_READY

Export all as frozen objects / TypeScript enums. These are consumed by the API and frontend.

## FRD References

- Domain 4.0 Section 2.1: 11 claim states with 5 terminal states (paid, adjusted, written_off, expired, deleted).
- Domain 4.0 Section 2.2: State transition table defining all valid From -> To pairs with triggers.
- Domain 4.0 Section 2.4: Three auto-submission modes — Auto Clean (default), Auto All, Require Approval.
- Domain 4.0 Section 4.3: Shared validation checks S1-S7 with severity levels.
- Domain 4.0 Section 7.5: 11 notification events emitted at key lifecycle moments.

## Prerequisites

- None. This is the first task in Domain 4.
- The `packages/shared/src/constants/` directory must exist (created by Domain 1).

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
