# Task D04-005: Zod validation schemas for claim CRUD and state transition endpoints

## Project Context
- Monorepo: Turborepo + pnpm workspaces
- API: `apps/api` (Fastify 5, TypeScript)
- Shared: `packages/shared` (Drizzle schemas, Zod validators, constants)
- DB: PostgreSQL 16 with Drizzle ORM
- Test: Vitest + Supertest
- Auth: Lucia sessions with RBAC middleware from Domain 1
- All queries MUST include physician_id for tenant isolation (HIA custodian boundary)
- Claims contain PHI — no PHI in logs, errors, or emails. PHN masked as 123******
- State machine: 11 states, 5 terminal. Transitions enforced at service layer.

## What to Build

Create `packages/shared/src/schemas/claim.schema.ts` with Zod schemas for request/response validation:

**Claim creation:**
- createClaimSchema: { claim_type: enum('AHCIP','WCB'), patient_id: uuid(), date_of_service: date string, import_source: enum('MANUAL','EMR_IMPORT','ED_SHIFT').default('MANUAL') }

**Claim update:**
- updateClaimSchema: partial object with allowed editable fields. claim_type is NOT editable after creation.

**Claim query/list:**
- listClaimsSchema: { state: enum(ClaimState).optional(), claim_type: enum('AHCIP','WCB').optional(), date_from: date.optional(), date_to: date.optional(), patient_id: uuid().optional(), is_clean: boolean().optional(), page: number().int().min(1).default(1), page_size: number().int().min(1).max(100).default(25) }

**State transitions:**
- queueClaimSchema: { } (no body, claim_id from path)
- writeOffClaimSchema: { reason: string().min(1).max(500) }
- resubmitClaimSchema: { } (no body, revalidates and requeues)

**AI Coach:**
- dismissSuggestionSchema: { reason: string().max(500).optional() }

**Param schemas:**
- claimIdParamSchema: { id: uuid() }
- suggestionIdParamSchema: { sug_id: uuid() }

Export all schemas AND their inferred TypeScript types (z.infer<typeof schema>).

## FRD References

- Domain 4.0 Section 6.1: Claim CRUD API contracts — POST create, GET retrieve, PUT update, DELETE soft-delete, GET list with filtering.
- Domain 4.0 Section 6.5: Rejection management — resubmit endpoint.
- Domain 4.0 Section 6.6: AI Coach interactions — accept/dismiss suggestion.

## Dependencies

- D04-001 must be complete (claim constants for enum values).

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
