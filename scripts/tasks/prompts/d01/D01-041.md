# Task D01-041: Security: authorization and role enforcement

## What to Build

Create `apps/api/test/security/iam/iam.authz.security.ts`.

Test role-based access control:

**Delegate cannot access physician-only routes:**
- POST /delegates/invite as delegate → 403
- PATCH /delegates/:id/permissions as delegate → 403
- DELETE /delegates/:id as delegate → 403
- POST /account/delete as delegate → 403

**Physician cannot access delegate-only routes:**
- GET /delegates/physicians as physician → 403 (or empty, depending on design)

**Delegate permission boundary tests:**
- Create delegate with CLAIM_VIEW only. Verify delegate cannot access routes requiring CLAIM_CREATE.
- Create delegate with no AUDIT_VIEW. Verify delegate cannot access /account/audit-log.

**Permission escalation prevention:**
- Delegate cannot call PATCH /delegates/:id/permissions to modify their own permissions.
- Delegate cannot call POST /delegates/invite to create other delegates.

## Prerequisites

This task depends on the following completed tasks: D01-031, D01-032

## Run After Completion

```bash
pnpm --filter api vitest run test/security/iam/iam.authz.security.ts
```

All tests must pass before outputting [TASK_COMPLETE].