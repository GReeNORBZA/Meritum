# Task D01-042: Security: cross-user isolation (tenant scoping)

## What to Build

Create `apps/api/test/security/iam/iam.scoping.security.ts`.

Create two physician accounts (physician1, physician2) using createSecurityPair fixture.

**Session isolation:**
- Physician1 cannot see physician2's sessions via GET /sessions
- Physician1 cannot revoke physician2's session via DELETE /sessions/:id → 404

**Delegate isolation:**
- Physician1 cannot see physician2's delegates via GET /delegates
- Physician1 cannot modify physician2's delegate via PATCH /delegates/:id/permissions → 404
- Physician1 cannot revoke physician2's delegate via DELETE /delegates/:id → 404

**Audit log isolation:**
- Physician1's audit log query never returns physician2's entries

**Delegate cross-context isolation:**
- Create delegate linked to physician1 only
- Delegate cannot switch to physician2 context (no active linkage) → 403
- If delegate is linked to both: data in physician1 context does not leak into physician2 context

**Important:** All cross-user access attempts return 404, not 403 (do not confirm resource existence).

## Prerequisites

This task depends on the following completed tasks: D01-031, D01-032

## Run After Completion

```bash
pnpm --filter api vitest run test/security/iam/iam.scoping.security.ts
```

All tests must pass before outputting [TASK_COMPLETE].