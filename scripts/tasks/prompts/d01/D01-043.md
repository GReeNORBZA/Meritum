# Task D01-043: Security: input validation and injection prevention

## What to Build

Create `apps/api/test/security/iam/iam.input.security.ts`.

**SQL injection payloads on all string inputs:**
- email field: `' OR 1=1--`, `'; DROP TABLE users;--`
- full_name field: SQL injection payloads
- password field: SQL injection payloads (must be accepted as valid password if meeting requirements, but parameterised queries prevent injection)

**XSS payloads on all stored text fields:**
- full_name: `<script>alert(1)</script>`
- phone: `<img onerror=alert(1) src=x>`

**Type coercion attacks:**
- Send number where string expected, array where string expected, null where required
- Send negative page_size to audit log query
- Send page_size > 200 to audit log query (should cap at 200)

**Password validation:**
- Password with 11 characters (below minimum 12) → 400
- Password without uppercase → 400
- Password without digit → 400
- Password without special character → 400

**UUID parameter validation:**
- Non-UUID in path params (e.g., DELETE /sessions/not-a-uuid) → 400

**TOTP validation:**
- TOTP code with letters → 400
- TOTP code with 5 digits → 400
- TOTP code with 7 digits → 400

## Prerequisites

This task depends on the following completed tasks: D01-031, D01-032

## Run After Completion

```bash
pnpm --filter api vitest run test/security/iam/iam.input.security.ts
```

All tests must pass before outputting [TASK_COMPLETE].