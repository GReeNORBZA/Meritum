# D11-099 — Full Domain Test Suite: All Unit + Integration + Security Tests

**Task ID:** D11-099
**Domain:** 11 — Onboarding
**Section:** Final Validation
**Depends on:** D11-040, D11-041, D11-042, D11-043, D11-044, D11-045
**Verify:** `pnpm --filter api vitest run src/domains/onboarding/ test/integration/onboarding/ test/security/onboarding/`

---

## Build Instructions

Run the complete test suite for Domain 11 Onboarding. Do NOT write new code unless tests fail.

### Step 1: Run All Unit Tests

```bash
pnpm --filter api vitest run src/domains/onboarding/
```

### Step 2: Run All Integration Tests

```bash
pnpm --filter api vitest run test/integration/onboarding/
```

### Step 3: Run All Security Tests

```bash
pnpm --filter api vitest run test/security/onboarding/
```

### Step 4: Fix Any Failures

If any tests fail:
1. Read the failure output carefully
2. Fix the **source code** (not the tests, unless the test itself is wrong)
3. Re-run the failing test suite

### Step 5: Final Full Suite Run

After all individual suites pass, run the complete suite one final time:

```bash
pnpm --filter api vitest run src/domains/onboarding/ test/integration/onboarding/ test/security/onboarding/
```

### Step 6: Verify Security Test File Existence

Verify these security test files exist and are non-empty:

- `test/security/onboarding/onboarding.authn.security.ts`
- `test/security/onboarding/onboarding.authz.security.ts`
- `test/security/onboarding/onboarding.scoping.security.ts`
- `test/security/onboarding/onboarding.input.security.ts`
- `test/security/onboarding/onboarding.leakage.security.ts`
- `test/security/onboarding/onboarding.audit.security.ts`

---

## Codebase Context

- **Unit tests:** `apps/api/src/domains/onboarding/onboarding.test.ts`
- **Integration tests:** `apps/api/test/integration/onboarding/`
  - `onboarding-progress.integration.ts`
  - `onboarding-documents.integration.ts`
  - `onboarding-supplementary.integration.ts`
- **Security tests:** `apps/api/test/security/onboarding/`
  - `onboarding.authn.security.ts`
  - `onboarding.authz.security.ts`
  - `onboarding.scoping.security.ts`
  - `onboarding.input.security.ts`
  - `onboarding.leakage.security.ts`
  - `onboarding.audit.security.ts`
- **Expected total:** All tests across unit, integration, and security suites must pass with zero failures.
