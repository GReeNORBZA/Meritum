# D11-002 — Drizzle Schema for onboarding_progress Table

**Task ID:** D11-002
**Domain:** 11 — Onboarding
**Section:** Shared Types & Constants
**Depends on:** D11-001
**Verify:** `pnpm --filter shared build`

---

## Build Instructions

Create `packages/shared/src/schemas/db/onboarding.schema.ts` with the `onboarding_progress` table.

### onboarding_progress Table

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| progress_id | UUID | PK | Default: gen_random_uuid() |
| provider_id | UUID FK | NOT NULL, UNIQUE, FK -> providers | One progress record per provider |
| step_1_completed | BOOLEAN | NOT NULL, DEFAULT false | Professional Identity |
| step_2_completed | BOOLEAN | NOT NULL, DEFAULT false | Specialty & Type |
| step_3_completed | BOOLEAN | NOT NULL, DEFAULT false | Business Arrangement |
| step_4_completed | BOOLEAN | NOT NULL, DEFAULT false | Practice Location |
| step_5_completed | BOOLEAN | NOT NULL, DEFAULT false | WCB Configuration (optional) |
| step_6_completed | BOOLEAN | NOT NULL, DEFAULT false | Submission Preferences (optional) |
| step_7_completed | BOOLEAN | NOT NULL, DEFAULT false | IMA Acknowledgement |
| patient_import_completed | BOOLEAN | NOT NULL, DEFAULT false | Optional patient import |
| guided_tour_completed | BOOLEAN | NOT NULL, DEFAULT false | Post-onboarding tour |
| guided_tour_dismissed | BOOLEAN | NOT NULL, DEFAULT false | Tour dismissed without completing |
| started_at | TIMESTAMPTZ | NOT NULL, DEFAULT now() | When onboarding began |
| completed_at | TIMESTAMPTZ | NULLABLE | When onboarding completed (all required steps done) |

### Indexes

- Unique index on `provider_id`.

### Exports

Export the table definition and its inferred types:
- `InsertOnboardingProgress`
- `SelectOnboardingProgress`

### Barrel Export

Update `packages/shared/src/schemas/db/index.ts` to re-export from `./onboarding.schema`.

---

## FRD References

- **Domain 11 Section 7.1:** onboarding_progress table with per-step boolean columns, tour tracking, and completion timestamp.

---

## Codebase Context

- **DB schema location:** `packages/shared/src/schemas/db/`
- **DB:** PostgreSQL via Drizzle ORM
- **Existing pattern:** Look at other schema files in `packages/shared/src/schemas/db/` for the established Drizzle table definition pattern (e.g., `pgTable`, column helpers, `InferInsertModel`, `InferSelectModel`).
- **FK reference:** The `provider_id` column references the `providers` table from Domain 05 (Provider Management). Import the providers table reference from the existing schema.
- **Barrel export:** Update `packages/shared/src/schemas/db/index.ts`
