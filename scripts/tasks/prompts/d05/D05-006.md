# Task D05-006: Drizzle schema for submission_preferences and hlink_configurations tables

## What to Build

Add to `packages/shared/src/schemas/db/provider.schema.ts`:

**submission_preferences table:**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| preference_id | UUID | PK | Default: gen_random_uuid() |
| provider_id | UUID FK | NOT NULL, UNIQUE, FK -> providers | One row per physician |
| ahcip_submission_mode | VARCHAR(20) | NOT NULL, DEFAULT 'AUTO_CLEAN' | AUTO_CLEAN, AUTO_ALL, REQUIRE_APPROVAL |
| wcb_submission_mode | VARCHAR(20) | NOT NULL, DEFAULT 'REQUIRE_APPROVAL' | AUTO_CLEAN, AUTO_ALL, REQUIRE_APPROVAL |
| batch_review_reminder | BOOLEAN | NOT NULL, DEFAULT true | Remind physician to review flagged claims before Thursday cutoff |
| deadline_reminder_days | INTEGER | NOT NULL, DEFAULT 7 | Days before submission deadline for first reminder |
| updated_at | TIMESTAMPTZ | NOT NULL, DEFAULT now() | |
| updated_by | UUID FK | NOT NULL | Who last changed preferences |

Indexes: unique on provider_id.

**hlink_configurations table:**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| hlink_config_id | UUID | PK | Default: gen_random_uuid() |
| provider_id | UUID FK | NOT NULL, UNIQUE, FK -> providers | One row per physician |
| submitter_prefix | VARCHAR(10) | NOT NULL | H-Link submitter prefix assigned during accreditation |
| credential_secret_ref | VARCHAR(100) | NOT NULL | Reference to credentials in secrets management. NOT the credentials |
| accreditation_status | VARCHAR(20) | NOT NULL, DEFAULT 'PENDING' | PENDING, ACTIVE, SUSPENDED |
| accreditation_date | DATE | NULLABLE | When H-Link accreditation was granted |
| last_successful_transmission | TIMESTAMPTZ | NULLABLE | Last successful batch transmission timestamp |
| created_at | TIMESTAMPTZ | NOT NULL, DEFAULT now() | |
| updated_at | TIMESTAMPTZ | NOT NULL, DEFAULT now() | |

Indexes: unique on provider_id.

Export tables and inferred types (InsertSubmissionPreferences, SelectSubmissionPreferences, InsertHlinkConfig, SelectHlinkConfig).

Use Drizzle ORM schema definitions. Follow existing schema patterns in `packages/shared/src/schemas/db/`. See `CLAUDE.md` for coding conventions.

## Critical Security Rules

- H-Link credentials (credential_secret_ref) is a REFERENCE KEY ONLY. The actual transmission credentials are stored in secrets management (DigitalOcean encrypted secrets). Never store plaintext credentials in this table.
- submission_preferences scoped to provider_id -- only the owning physician or their delegate can modify.

## Prerequisites

- D05-002 must be complete (providers table defined).

## FRD Reference

- Domain 5 Section 2.7: Submission Preferences table. One row per physician. Defaults: AUTO_CLEAN for AHCIP, REQUIRE_APPROVAL for WCB.
- Domain 5 Section 2.8: H-Link Configuration table. One row per physician. Credentials are references to secrets management -- actual values never stored in database.

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
