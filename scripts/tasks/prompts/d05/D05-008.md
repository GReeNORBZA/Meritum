# Task D05-008: Zod validation schemas for delegate, submission preferences, H-Link, internal API

## What to Build

Add to `packages/shared/src/schemas/provider.schema.ts`:

**Delegate Management:**
- `inviteDelegateSchema`: `{ email: string().email().max(255), permissions: array(enum(DELEGATE_PERMISSION_KEYS)).min(1) }`
- `updateDelegatePermissionsSchema`: `{ permissions: array(enum(DELEGATE_PERMISSION_KEYS)).min(1) }`
- `delegateRelIdParamSchema`: `{ rel_id: string().uuid() }`
- `acceptInvitationSchema`: `{ token: string().min(1) }`
- `switchContextParamSchema`: `{ provider_id: string().uuid() }`

Import DELEGATE_PERMISSION_KEYS from `packages/shared/src/constants/provider.constants.ts` and use them as the enum source for permissions validation.

**Submission Preferences:**
- `updateSubmissionPreferencesSchema`: `{ ahcip_submission_mode: enum(['AUTO_CLEAN','AUTO_ALL','REQUIRE_APPROVAL']).optional(), wcb_submission_mode: enum(['AUTO_CLEAN','AUTO_ALL','REQUIRE_APPROVAL']).optional(), batch_review_reminder: boolean().optional(), deadline_reminder_days: number().int().min(1).max(30).optional() }`

**H-Link Configuration:**
- `updateHlinkConfigSchema`: `{ submitter_prefix: string().min(1).max(10).optional(), accreditation_status: enum(['PENDING','ACTIVE','SUSPENDED']).optional() }`

**Internal Provider Context API:**
- `providerIdParamSchema`: `{ id: string().uuid() }`
- `baForClaimQuerySchema`: `{ claim_type: enum(['AHCIP','WCB']), hsc_code: string().optional() }`
- `wcbConfigForFormQuerySchema`: `{ form_id: string().min(1) }`

**Provider Context Response Type (TypeScript interface, not Zod):**
Define `ProviderContext` type matching Section 6 of the FRD:
```typescript
interface ProviderContext {
  provider_id: string;
  billing_number: string;
  specialty_code: string;
  physician_type: string;
  bas: Array<{ ba_id: string; ba_number: string; ba_type: string; is_primary: boolean; status: string }>;
  default_location: { location_id: string; name: string; functional_centre: string; facility_number: string | null } | null;
  all_locations: Array<{ location_id: string; name: string; functional_centre: string; is_active: boolean }>;
  pcpcm_enrolled: boolean;
  pcpcm_ba_number: string | null;
  ffs_ba_number: string | null;
  wcb_configs: Array<{ wcb_config_id: string; contract_id: string; role_code: string; permitted_form_types: string[] }>;
  default_wcb_config: { wcb_config_id: string; contract_id: string; role_code: string } | null;
  submission_preferences: { ahcip_submission_mode: string; wcb_submission_mode: string; batch_review_reminder: boolean; deadline_reminder_days: number } | null;
  hlink_accreditation_status: string | null;
  hlink_submitter_prefix: string | null;
  onboarding_completed: boolean;
  status: string;
}
```

Export all schemas, types, and the ProviderContext interface. Follow existing Zod schema patterns. See `CLAUDE.md` for coding conventions.

## Prerequisites

- D05-001 must be complete (provider constants -- DELEGATE_PERMISSION_KEYS used in schemas).
- D05-007 must be complete (first set of Zod schemas in the same file).

## FRD Reference

- Domain 5 Section 5.5-5.8: API contracts for delegate management, submission preferences, H-Link configuration, and internal provider context endpoints.
- Domain 5 Section 6: Provider Context Object specification -- 17 fields consumed by Claim Lifecycle (Domain 4).

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
