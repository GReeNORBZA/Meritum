# D07-001: Intelligence Engine constants: tiers, suggestion categories, priorities, statuses, event types, learning thresholds

## Project Context
You are building **Meritum Health Technologies**, a self-serve medical billing platform for Alberta physicians (AHCIP + WCB claims). This is a monorepo with:
- `apps/api` — Fastify 5 REST API with Drizzle ORM, PostgreSQL 16
- `apps/web` — Next.js 15 frontend
- `packages/shared` — Shared Drizzle schemas, Zod validators, constants, utilities

Tech stack: TypeScript, Fastify 5, Drizzle ORM, PostgreSQL 16, Vitest + Supertest, Lucia auth.

Read `CLAUDE.md` in the project root for full conventions (naming, structure, error handling, security, testing).

## What to Build
Create `packages/shared/src/constants/intelligence.constants.ts` with all Intelligence Engine constants:

**Tiers enum:**
- TIER_1 (Deterministic Rules Engine — zero LLM cost, ~80% of suggestions)
- TIER_2 (Self-Hosted LLM — low cost, ~15% of suggestions)
- TIER_3 (Review Recommended — human review, ~5% of cases)

**Suggestion Categories (11 total):**
- MODIFIER_ADD: suggest adding a modifier (Tier 1, 2)
- MODIFIER_REMOVE: modifier is invalid or suboptimal (Tier 1)
- CODE_ALTERNATIVE: different HSC code more appropriate (Tier 1, 2)
- CODE_ADDITION: additional code billable for same encounter (Tier 1, 2)
- MISSED_BILLING: billable service performed but not claimed (Tier 1, 2)
- REJECTION_RISK: claim likely to be rejected (Tier 1)
- DOCUMENTATION_GAP: required documentation missing (Tier 1)
- FEE_OPTIMISATION: different billing approach yields more revenue (Tier 1, 2)
- WCB_TIMING: WCB tier will downgrade if not submitted sooner (Tier 1)
- WCB_COMPLETENESS: WCB form has fields that improve acceptance (Tier 1)
- REVIEW_RECOMMENDED: case too complex for automated analysis (Tier 3)

**Suggestion Priorities:** HIGH, MEDIUM, LOW

**Priority thresholds (defaults, configurable per specialty):**
- HIGH: revenue_impact > $20 OR rejection risk confidence > 0.80
- MEDIUM: revenue_impact $5–$20 OR rejection risk 0.50–0.80
- LOW: revenue_impact < $5, informational, or documentation

**Suggestion Statuses:** PENDING, ACCEPTED, DISMISSED

**Suggestion Event Types:** GENERATED, ACCEPTED, DISMISSED, SUPPRESSED, UNSUPPRESSED

**Rule Claim Types:** AHCIP, WCB, BOTH

**Learning Loop Constants:**
- SUPPRESSION_THRESHOLD: 5 (consecutive dismissals before rule is suppressed)
- MIN_COHORT_SIZE: 10 (minimum physicians per specialty cohort before aggregates used)
- CALIBRATION_CLAIMS: 50 (claims before personalisation overrides specialty defaults)
- ROLLING_WINDOW_DAYS: 90 (for seasonal pattern detection)
- LLM_TIMEOUT_MS: 3000 (Tier 2 latency budget)
- LLM_CONFIDENCE_THRESHOLD: 0.60 (below this → escalate to Tier 3)

**MVP Rule Categories and approximate counts:**
- Modifier Eligibility: ~30 rules
- Rejection Prevention: ~40 rules
- WCB-Specific: ~20 rules
- Pattern-Based: ~15 rules
- Total MVP: ~105 rules

Export all as frozen objects / TypeScript enums.

## FRD References
- Domain 7 Section 1.2: Three-tier architecture with percentage breakdown. Section 2.2: 11 suggestion categories with tier applicability.
- Domain 7 Section 2.3: Priority thresholds. Section 6.2: Learning loop adaptation mechanisms (suppression=5, cohort min=10, 90-day rolling window).
- Domain 7 Section 4.3: LLM timeout 3s, confidence threshold 0.60.

## Tests
No specific unit tests for this task — verified by build command.

## Run After Completion
After completing your changes, run:
```bash
pnpm --filter shared build
```
Fix any errors before finishing.
