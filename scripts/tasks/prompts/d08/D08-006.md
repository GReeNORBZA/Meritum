# D08-006: Database migration for all Domain 8 tables

## Project Context
You are building **Meritum Health Technologies**, a self-serve medical billing platform for Alberta physicians (AHCIP + WCB claims). This is a monorepo with:
- `apps/api` — Fastify 5 REST API with Drizzle ORM, PostgreSQL 16
- `apps/web` — Next.js 15 frontend
- `packages/shared` — Shared Drizzle schemas, Zod validators, constants, utilities

Tech stack: TypeScript, Fastify 5, Drizzle ORM, PostgreSQL 16, Vitest + Supertest, Lucia auth.

Read `CLAUDE.md` in the project root for full conventions (naming, structure, error handling, security, testing).

## Dependencies
This task depends on: **D08-002**, **D08-003**, **D08-004** (all three table schemas must exist first).

## What to Build
Generate and run Drizzle migration for Domain 8 tables.

The migration should create:
1. analytics_cache table with all columns, indexes, and FK to providers
2. generated_reports table with all columns, indexes, and FK to providers
3. report_subscriptions table with all columns, indexes, and FK to providers

Verify FK references to providers table (Domain 5) resolve correctly.

Run `pnpm --filter api drizzle-kit generate` to create migration file.
Run `pnpm --filter api drizzle-kit migrate` to apply.
Verify all three tables exist with correct schema.

## FRD References
- Domain 8 Section 7: All three data model tables.

## Security Considerations
- provider_id FK ensures referential integrity — no orphan analytics data.
- Unique constraints prevent duplicate cache entries and subscriptions.

## Tests
No specific unit tests — verified by migration commands.

## Run After Completion
After completing your changes, run:
```bash
pnpm --filter api drizzle-kit generate && pnpm --filter api drizzle-kit migrate
```
Fix any errors before finishing.
