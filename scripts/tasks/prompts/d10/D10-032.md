# D10-032 â€” Quick claim and mobile summary routes, sync placeholder

## Task ID
D10-032

## Description
Create Fastify routes for quick claim entry, mobile patient creation, recent patients, mobile summary, and the Phase 2 sync placeholder.

## Dependencies
- D10-022 (quick claim service)
- D10-023 (mobile summary service)
- D10-004 (Zod validation schemas)

## Build Instructions

Create `apps/api/src/domains/mobile/routes/mobile.routes.ts` and test file `apps/api/src/domains/mobile/routes/mobile.routes.test.ts`.

Register Fastify routes. All require authentication (except sync placeholder).

**Routes:**

1. `POST /api/v1/mobile/quick-claim` -- body validated by QuickClaimSchema. Create draft AHCIP claim. Returns created claim. Permission: CLAIM_CREATE.
2. `POST /api/v1/mobile/patients` -- body validated by MobilePatientSchema. Create minimal patient record. Returns created patient. Permission: PATIENT_CREATE.
3. `GET /api/v1/mobile/recent-patients` -- query: { limit?: number(1-20, default 20) }. Returns recent patients for quick entry. Permission: PATIENT_VIEW.
4. `GET /api/v1/mobile/summary` -- no params. Returns lightweight KPI summary for home screen. Permission: CLAIM_VIEW.
5. `POST /api/v1/sync/claims` -- Phase 2 placeholder. Returns 501 Not Implemented with body { message: 'Offline sync is not available in this version', phase: 2 }. No authentication required for 501 response (client may call without valid session when reconnecting).

**Route-level unit tests:** quick claim creates draft, mobile patient creation, recent patients, summary response shape, sync returns 501.

## FRD References
- Domain 10 Section 3: Quick claim entry flow and constraints.
- Domain 10 Section 8.3: GET /api/v1/mobile/summary endpoint (Table 8).
- Domain 10 Section 6: Offline queue Phase 2 -- sync endpoint returns 501 at MVP.

## Security Requirements
- Quick claim creates AHCIP draft only -- reject if claim_type != AHCIP.
- Sync endpoint returns 501 -- no data processed. Safe to leave unauthenticated for reconnection scenario.
- Mobile patient creation still validates PHN format and enforces provider_id scoping.

## Codebase Context
- Route files go in `apps/api/src/domains/mobile/routes/`.
- Test pattern: unit tests co-located as `*.test.ts`.
- Auth pattern: session cookie auth with `request.session.user` containing `{ id, role, physician_id }`. Roles: physician, delegate, admin.
- Zod validation schemas from `packages/shared/src/schemas/validation/mobile.validation.ts` (D10-004).
- Quick claims are AHCIP-only, always draft state, source='mobile_quick_entry'.
- Sync endpoint returns 501 (Phase 2 placeholder).
- PHN masking: display as `123******`.
- See existing route patterns in other domains for Fastify route registration.

## Verification
```bash
pnpm --filter api vitest run src/domains/mobile/routes/mobile.routes.test.ts
```
