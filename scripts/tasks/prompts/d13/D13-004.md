# D13-004: Drizzle schema for article_feedback table

**Domain:** 13 â€” Support System
**Task ID:** D13-004
**Depends on:** D13-003
**Verify:** `pnpm --filter shared build`

---

## Build Instructions

Add to `packages/shared/src/schemas/db/support.schema.ts` the article_feedback table.

**article_feedback table:**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| feedback_id | UUID | PK | Default: gen_random_uuid() |
| article_id | UUID FK | NOT NULL | FK to help_articles |
| provider_id | UUID FK | NOT NULL | FK to providers (who gave feedback) |
| is_helpful | BOOLEAN | NOT NULL | true = helpful, false = not helpful |
| created_at | TIMESTAMPTZ | NOT NULL, DEFAULT now() | |

**Indexes:**
- UNIQUE on (article_id, provider_id) -- one feedback per physician per article
- Index on (article_id) for aggregate counts

Export table and inferred types.

---

## FRD References

- Domain 13 Section 2.2: 'Was this helpful?' on every article. Low-rated articles prioritised for rewrite.

---

## Codebase Context

- **DB schemas location:** `packages/shared/src/schemas/db/support.schema.ts` (same file as D13-002 and D13-003).
- **FK references:** article_id references `helpArticles.article_id`, provider_id references `providers.provider_id`.
- **Unique constraint:** Use Drizzle's `.unique()` on the combination of (article_id, provider_id) to enforce one feedback per physician per article.
- **Barrel exports:** Update `packages/shared/src/schemas/db/index.ts` and `packages/shared/src/schemas/index.ts` to re-export article feedback types.
- **Type inference pattern:** `export type InsertArticleFeedback = typeof articleFeedback.$inferInsert;` and `export type SelectArticleFeedback = typeof articleFeedback.$inferSelect;`.
