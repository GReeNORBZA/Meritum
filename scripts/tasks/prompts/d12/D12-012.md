# Task D12-012: Repository: status page components and incidents

## What to Build

Add to `apps/api/src/domains/platform/platform.repository.ts`:

**Status components:**
- `listComponents()` — return all components ordered by sort_order.
- `updateComponentStatus(componentId: string, status: string)` — update component health status.
- `seedComponents(components: Array<{ name, displayName, sortOrder }>)` — idempotent seed for the 8 monitored components.

**Incidents:**
- `createIncident(data: { title, severity, affectedComponents, initialMessage })` — create incident + first update entry.
- `updateIncident(incidentId: string, status: string, message: string)` — add update to incident, change incident status. Set resolved_at if status is 'resolved'.
- `listActiveIncidents()` — return non-resolved incidents with their updates, ordered by created_at DESC.
- `listIncidentHistory(pagination: { page, pageSize })` — all incidents (including resolved) paginated.
- `findIncidentById(incidentId: string)` — single incident with all updates.

## Prerequisites

This task depends on the following completed tasks: D12-006

## Tests to Write

```typescript
  it('listComponents returns all components in sort order');
  it('updateComponentStatus changes status');
  it('seedComponents is idempotent (running twice creates no duplicates)');
  it('createIncident creates incident with first update');
  it('updateIncident adds update and changes status');
  it('updateIncident sets resolved_at when resolving');
  it('listActiveIncidents excludes resolved incidents');
  it('listIncidentHistory includes all incidents paginated');
  it('findIncidentById returns incident with all updates');
```

## Run After Completion

```bash
pnpm --filter api vitest run src/domains/platform/platform.test.ts
```

All tests must pass before outputting [TASK_COMPLETE].
