# Task D12-004: Drizzle schema for referral_codes and referral_redemptions tables (MVP accommodation)

## What to Build

Add to `packages/shared/src/schemas/db/platform.schema.ts`:

**referral_codes table (MVP accommodation — schema defined, not actively used):**

| Column | Type | Constraints |
|--------|------|-------------|
| referral_code_id | UUID | PK |
| physician_user_id | UUID FK | NOT NULL, FK → users |
| code | VARCHAR(20) | NOT NULL, UNIQUE |
| redemption_count | INTEGER | NOT NULL, DEFAULT 0 |
| max_redemptions | INTEGER | NOT NULL, DEFAULT 10 |
| is_active | BOOLEAN | NOT NULL, DEFAULT false (disabled at MVP) |
| created_at | TIMESTAMPTZ | NOT NULL |

**referral_redemptions table (MVP accommodation):**

| Column | Type | Constraints |
|--------|------|-------------|
| redemption_id | UUID | PK |
| referral_code_id | UUID FK | NOT NULL, FK → referral_codes |
| referred_user_id | UUID FK | NOT NULL, FK → users |
| credit_amount_cad | DECIMAL(10,2) | NOT NULL, DEFAULT 50.00 |
| credit_applied | BOOLEAN | NOT NULL, DEFAULT false |
| created_at | TIMESTAMPTZ | NOT NULL |

These tables are created in migration but not populated at MVP. The referral program activates post-PMF.

Export all tables and inferred types.

## Prerequisites

This task depends on the following completed tasks: D12-002

## FRD Reference

Domain 12 Section 7: Referral program post-PMF. $50 credit per referral. Max 10 per physician per year ($500/year cap). MVP: schema defined, code field hidden/disabled.

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
