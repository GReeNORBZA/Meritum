# Task D12-043: Security: input validation and injection prevention

## What to Build

Create `apps/api/test/security/platform/platform.input.security.ts`.

**SQL injection payloads on string inputs:**
- plan field: `' OR 1=1--`
- success_url field: SQL injection payloads
- Incident title: SQL injection payloads
- Incident message: SQL injection payloads

**XSS payloads on stored text fields:**
- Incident title: `<script>alert(1)</script>`
- Incident message: `<img onerror=alert(1) src=x>`
- Component status: XSS payloads

**Type coercion attacks:**
- Send number where string expected, array where string expected
- Send negative page_size to payment history → 400
- Send page_size > 100 to admin subscriptions → capped at 100

**UUID parameter validation:**
- Non-UUID in path params (e.g., PATCH /admin/subscriptions/not-a-uuid) → 400

**URL validation:**
- success_url with javascript: protocol → 400
- success_url with data: protocol → 400
- cancel_url with non-HTTP URL → 400

**Plan validation:**
- Invalid plan name → 400
- Empty plan → 400

**Webhook body tampering:**
- Valid signature but modified body → 400 (signature mismatch)
- Oversized webhook body → 400

## Prerequisites

This task depends on the following completed tasks: D12-031, D12-032

## Run After Completion

```bash
pnpm --filter api vitest run test/security/platform/platform.input.security.ts
```

All tests must pass before outputting [TASK_COMPLETE].
