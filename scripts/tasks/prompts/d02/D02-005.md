# Task D02-005: Drizzle schema for di_codes, rrnp_communities, and pcpcm_baskets tables

## What to Build

Add to `packages/shared/src/schemas/db/reference.schema.ts`:

**di_codes table (~14,000 records):**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| id | UUID | PK | Default: gen_random_uuid() |
| di_code | VARCHAR(10) | NOT NULL | Diagnostic code |
| description | TEXT | NOT NULL | Full description |
| category | VARCHAR(100) | NOT NULL | DI category |
| subcategory | VARCHAR(100) | NULLABLE | DI subcategory |
| qualifies_surcharge | BOOLEAN | NOT NULL, DEFAULT false | Attachment G surcharge qualifier |
| qualifies_bcp | BOOLEAN | NOT NULL, DEFAULT false | Business Cost Premium qualifier |
| common_in_specialty | JSONB | NOT NULL, DEFAULT '[]' | Array of specialty codes where this DI is common |
| help_text | TEXT | NULLABLE | User-facing contextual help |
| version_id | UUID FK | NOT NULL, FK -> reference_data_versions | Parent version |
| effective_from | DATE | NOT NULL | Denormalised from version |
| effective_to | DATE | NULLABLE | Denormalised from version |

**Indexes:** (di_code, version_id), pg_trgm on di_code and description for fuzzy search, GIN index on description for full-text search.

**rrnp_communities table (~100-200 records):**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| community_id | UUID | PK | Default: gen_random_uuid() |
| community_name | VARCHAR(200) | NOT NULL | Community name |
| rrnp_percentage | DECIMAL(5,2) | NOT NULL | RRNP premium percentage |
| rrnp_tier | VARCHAR(20) | NULLABLE | Tier classification |
| region | VARCHAR(100) | NULLABLE | Geographic region |
| version_id | UUID FK | NOT NULL, FK -> reference_data_versions | Parent version |
| effective_from | DATE | NOT NULL | Denormalised from version |
| effective_to | DATE | NULLABLE | Denormalised from version |

**Indexes:** (community_name, version_id).

**pcpcm_baskets table (~3,000-4,000 records):**

| Column | Type | Constraints | Notes |
|--------|------|-------------|-------|
| id | UUID | PK | Default: gen_random_uuid() |
| hsc_code | VARCHAR(10) | NOT NULL | HSC code reference |
| basket | VARCHAR(20) | NOT NULL | in_basket, out_of_basket, facility |
| notes | TEXT | NULLABLE | Classification notes |
| version_id | UUID FK | NOT NULL, FK -> reference_data_versions | Parent version |
| effective_from | DATE | NOT NULL | Denormalised from version |
| effective_to | DATE | NULLABLE | Denormalised from version |

**Indexes:** (hsc_code, version_id).

Use Drizzle ORM's `pgTable`. Follow the same patterns used in existing tables in this schema file.

Export all tables and inferred types (InsertDiCode, SelectDiCode, InsertRrnpCommunity, SelectRrnpCommunity, InsertPcpcmBasket, SelectPcpcmBasket).

## Prerequisites

- D02-002 must be complete (reference_data_versions table exists for FK reference).

## FRD Reference

- Domain 2 Section 2.6: DI codes ~14,000 with surcharge/BCP flags.
- Domain 2 Section 2.7: RRNP ~100-200 communities with percentage rates.
- Domain 2 Section 2.8: PCPCM ~3,000-4,000 HSC classifications.

## Run After Completion

```bash
pnpm --filter shared build
```

All tests must pass before outputting [TASK_COMPLETE].
